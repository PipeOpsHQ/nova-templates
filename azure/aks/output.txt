module.aks.null_resource.kubernetes_version_keeper: Refreshing state... [id=2491964805236982761]
module.aks.null_resource.pool_name_keeper["test"]: Refreshing state... [id=5351478033670670450]
module.aks.null_resource.kubernetes_cluster_name_keeper: Refreshing state... [id=7498848021410546612]
data.azurerm_subnet.pipeops_subnet: Reading...
data.azurerm_resource_group.pipeops_rg: Reading...
module.aks.data.azurerm_client_config.this: Reading...
module.aks.data.azurerm_client_config.this: Read complete after 0s [id=Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9ZWRiMzI2MWUtOTZkNS00NzU2LThlMmUtNjI3ZWVjZmYzZjM1O3N1YnNjcmlwdGlvbklkPWYxOGQwMWE2LTVkNDctNGJlNy05NzY1LTZiNDU2YjkwZGYwOTt0ZW5hbnRJZD1mOWZmNjM4NS01NTg0LTQ2YjQtYmNlYy1jOGZhODdhMjU1MTU=]
data.azurerm_subnet.pipeops_subnet: Read complete after 2s [id=/subscriptions/f18d01a6-5d47-4be7-9765-6b456b90df09/resourceGroups/sre-test/providers/Microsoft.Network/virtualNetworks/pipeops-network/subnets/pipeops-subnet-3]
data.azurerm_resource_group.pipeops_rg: Read complete after 3s [id=/subscriptions/f18d01a6-5d47-4be7-9765-6b456b90df09/resourceGroups/sre-test]
module.aks.data.azurerm_resource_group.main: Reading...
module.aks.data.azurerm_resource_group.aks_rg[0]: Reading...
module.aks.data.azurerm_resource_group.aks_rg[0]: Read complete after 1s [id=/subscriptions/f18d01a6-5d47-4be7-9765-6b456b90df09/resourceGroups/sre-test]
module.aks.data.azurerm_resource_group.main: Read complete after 3s [id=/subscriptions/f18d01a6-5d47-4be7-9765-6b456b90df09/resourceGroups/sre-test]

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # module.aks.azapi_update_resource.aks_cluster_post_create will be created
  + resource "azapi_update_resource" "aks_cluster_post_create" {
      + body                    = jsonencode(
            {
              + properties = {
                  + kubernetesVersion = "1.30"
                }
            }
        )
      + id                      = (known after apply)
      + ignore_casing           = false
      + ignore_missing_property = true
      + name                    = (known after apply)
      + output                  = (known after apply)
      + parent_id               = (known after apply)
      + resource_id             = (known after apply)
      + type                    = "Microsoft.ContainerService/managedClusters@2024-02-01"
    }

  # module.aks.azurerm_kubernetes_cluster.main will be created
  + resource "azurerm_kubernetes_cluster" "main" {
      + api_server_authorized_ip_ranges     = (known after apply)
      + azure_policy_enabled                = false
      + cost_analysis_enabled               = false
      + current_kubernetes_version          = (known after apply)
      + dns_prefix                          = "pipeops-test"
      + fqdn                                = (known after apply)
      + http_application_routing_zone_name  = (known after apply)
      + id                                  = (known after apply)
      + image_cleaner_enabled               = false
      + image_cleaner_interval_hours        = 48
      + kube_admin_config                   = (sensitive value)
      + kube_admin_config_raw               = (sensitive value)
      + kube_config                         = (sensitive value)
      + kube_config_raw                     = (sensitive value)
      + kubernetes_version                  = "1.30"
      + location                            = "westeurope"
      + name                                = "pipeops-test"
      + node_resource_group                 = (known after apply)
      + node_resource_group_id              = (known after apply)
      + oidc_issuer_enabled                 = true
      + oidc_issuer_url                     = (known after apply)
      + portal_fqdn                         = (known after apply)
      + private_cluster_enabled             = true
      + private_cluster_public_fqdn_enabled = false
      + private_dns_zone_id                 = (known after apply)
      + private_fqdn                        = (known after apply)
      + public_network_access_enabled       = true
      + resource_group_name                 = "sre-test"
      + role_based_access_control_enabled   = false
      + run_command_enabled                 = true
      + sku_tier                            = "Free"
      + support_plan                        = "KubernetesOfficial"
      + tags                                = {
          + "Name" = "Production"
        }
      + workload_identity_enabled           = false

      + api_server_access_profile (known after apply)

      + auto_scaler_profile (known after apply)

      + default_node_pool {
          + enable_auto_scaling         = false
          + enable_host_encryption      = false
          + enable_node_public_ip       = false
          + kubelet_disk_type           = (known after apply)
          + max_pods                    = (known after apply)
          + name                        = "nodepool"
          + node_count                  = 2
          + node_labels                 = (known after apply)
          + orchestrator_version        = (known after apply)
          + os_disk_size_gb             = 50
          + os_disk_type                = "Managed"
          + os_sku                      = (known after apply)
          + scale_down_mode             = "Delete"
          + tags                        = {
              + "Name" = "Production"
            }
          + temporary_name_for_rotation = "pippss"
          + type                        = "VirtualMachineScaleSets"
          + ultra_ssd_enabled           = false
          + vm_size                     = "Standard_D2s_v3"
          + workload_runtime            = (known after apply)

          + upgrade_settings {
              + max_surge                     = "10%"
              + node_soak_duration_in_minutes = 0
            }
        }

      + identity {
          + principal_id = (known after apply)
          + tenant_id    = (known after apply)
          + type         = "SystemAssigned"
        }

      + kubelet_identity (known after apply)

      + network_profile {
          + dns_service_ip          = (known after apply)
          + docker_bridge_cidr      = (known after apply)
          + ebpf_data_plane         = (known after apply)
          + ip_versions             = (known after apply)
          + load_balancer_sku       = "standard"
          + network_data_plane      = (known after apply)
          + network_mode            = (known after apply)
          + network_plugin          = "kubenet"
          + network_policy          = (known after apply)
          + outbound_ip_address_ids = (known after apply)
          + outbound_ip_prefix_ids  = (known after apply)
          + outbound_type           = "loadBalancer"
          + pod_cidr                = (known after apply)
          + pod_cidrs               = (known after apply)
          + service_cidr            = (known after apply)
          + service_cidrs           = (known after apply)

          + load_balancer_profile (known after apply)

          + nat_gateway_profile (known after apply)
        }

      + windows_profile (known after apply)
    }

  # module.aks.azurerm_kubernetes_cluster_node_pool.node_pool_create_before_destroy["test"] will be created
  + resource "azurerm_kubernetes_cluster_node_pool" "node_pool_create_before_destroy" {
      + enable_auto_scaling   = true
      + id                    = (known after apply)
      + kubelet_disk_type     = (known after apply)
      + kubernetes_cluster_id = (known after apply)
      + max_pods              = (known after apply)
      + mode                  = "User"
      + name                  = (known after apply)
      + node_count            = 4
      + node_labels           = (known after apply)
      + orchestrator_version  = (known after apply)
      + os_disk_size_gb       = 50
      + os_disk_type          = "Managed"
      + os_sku                = (known after apply)
      + os_type               = "Linux"
      + priority              = "Regular"
      + scale_down_mode       = "Delete"
      + spot_max_price        = -1
      + tags                  = {
          + "Name" = "pipeops-nodegroup"
        }
      + ultra_ssd_enabled     = false
      + vm_size               = "Standard_B2as_v2"
    }

Plan: 3 to add, 0 to change, 0 to destroy.
module.aks.azurerm_kubernetes_cluster.main: Creating...
module.aks.azurerm_kubernetes_cluster.main: Still creating... [10s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [20s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [30s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [40s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [50s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [1m0s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [1m10s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [1m20s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [1m30s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [1m40s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [1m50s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [2m0s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [2m10s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [2m20s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [2m30s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [2m40s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [2m50s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [3m0s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [3m10s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [3m20s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [3m30s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [3m40s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [3m50s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [4m0s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [4m10s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [4m20s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [4m30s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [4m40s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [4m50s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [5m0s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [5m10s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [5m20s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [5m30s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [5m40s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [5m50s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [6m0s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [6m10s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [6m20s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [6m30s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [6m40s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [6m50s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [7m0s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [7m10s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [7m20s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [7m30s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [7m40s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [7m50s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Still creating... [8m0s elapsed]
module.aks.azurerm_kubernetes_cluster.main: Creation complete after 8m7s [id=/subscriptions/f18d01a6-5d47-4be7-9765-6b456b90df09/resourceGroups/sre-test/providers/Microsoft.ContainerService/managedClusters/pipeops-test]
module.aks.azapi_update_resource.aks_cluster_post_create: Creating...
module.aks.azapi_update_resource.aks_cluster_post_create: Still creating... [10s elapsed]
module.aks.azapi_update_resource.aks_cluster_post_create: Still creating... [20s elapsed]
module.aks.azapi_update_resource.aks_cluster_post_create: Still creating... [30s elapsed]
module.aks.azapi_update_resource.aks_cluster_post_create: Still creating... [40s elapsed]
module.aks.azapi_update_resource.aks_cluster_post_create: Still creating... [50s elapsed]
module.aks.azapi_update_resource.aks_cluster_post_create: Still creating... [1m0s elapsed]
module.aks.azapi_update_resource.aks_cluster_post_create: Still creating... [1m10s elapsed]
module.aks.azapi_update_resource.aks_cluster_post_create: Still creating... [1m20s elapsed]
module.aks.azapi_update_resource.aks_cluster_post_create: Still creating... [1m30s elapsed]
module.aks.azapi_update_resource.aks_cluster_post_create: Still creating... [1m40s elapsed]
module.aks.azapi_update_resource.aks_cluster_post_create: Still creating... [1m50s elapsed]
module.aks.azapi_update_resource.aks_cluster_post_create: Still creating... [2m0s elapsed]
module.aks.azapi_update_resource.aks_cluster_post_create: Still creating... [2m10s elapsed]
module.aks.azapi_update_resource.aks_cluster_post_create: Still creating... [2m20s elapsed]
module.aks.azapi_update_resource.aks_cluster_post_create: Still creating... [2m30s elapsed]
module.aks.azapi_update_resource.aks_cluster_post_create: Creation complete after 2m31s [id=/subscriptions/f18d01a6-5d47-4be7-9765-6b456b90df09/resourceGroups/sre-test/providers/Microsoft.ContainerService/managedClusters/pipeops-test]
module.aks.azurerm_kubernetes_cluster_node_pool.node_pool_create_before_destroy["test"]: Creating...
module.aks.azurerm_kubernetes_cluster_node_pool.node_pool_create_before_destroy["test"]: Still creating... [10s elapsed]

Warning: Deprecated attribute

  on .terraform/modules/aks/main.tf line 565, in resource "azurerm_kubernetes_cluster" "main":
 565:       public_network_access_enabled,

The attribute "public_network_access_enabled" is deprecated. Refer to the provider documentation for details.
